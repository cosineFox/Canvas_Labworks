# Local testing setup for Anubis + SvelteKit
# Run: docker-compose up
# Access: http://localhost:8923 (through Anubis)

services:
  anubis:
    image: ghcr.io/techarohq/anubis:latest
    container_name: anubis-proxy
    ports:
      - "8923:8923"
    environment:
      - BIND=:8923
      - TARGET=http://host.docker.internal:5173
      - DIFFICULTY=4
      - SERVE_ROBOTS_TXT=true
      - OG_PASSTHROUGH=true
      - OG_EXPIRY_TIME=1h
      - POLICY_FNAME=/etc/anubis/policy.json
    volumes:
      - ./anubis-policy.json:/etc/anubis/policy.json:ro
    extra_hosts:
      - "host.docker.internal:host-gateway"
    restart: unless-stopped

# Note: Run your SvelteKit dev server separately with `npm run dev`
# Then access the site through Anubis at http://localhost:8923
